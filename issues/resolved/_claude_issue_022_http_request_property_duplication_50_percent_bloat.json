{
  "issue_id": "_claude_issue_022",
  "title": "HTTP Request node has 50% property duplication - each property extracted twice",
  "severity": "high",
  "status": "resolved",
  "priority": 2,
  "metadata": {
    "created_at": "2025-11-07T00:00:00Z",
    "created_by": "claude_code",
    "affected_nodes": "HTTP Request (64 extracted, 33 unique expected) - likely affects other nodes with similar extraction patterns",
    "validation_session": "comprehensive_cross_reference_2025-11-07"
  },
  "description": {
    "problem": "HTTP Request node extracts 64 property entries when source contains 33 property definitions. Each property appears exactly twice - once without _source field, once with _source: '_mainProperties'",
    "impact": "HIGH - 50% file bloat in JSON data. UI elements duplicated (3 notices \u2192 6, 9 placeholders \u2192 18). Confuses AI models with duplicate property definitions. Wastes storage and processing. Pattern may affect multiple nodes.",
    "root_cause": "Properties are extracted twice during the extraction process:\n\n1st extraction: Properties extracted from main node file without _source tag\n2nd extraction: Same properties extracted again and tagged with _source: '_mainProperties'\n\nThis happens in NodeExtractor when processing properties arrays. The extractor likely:\n1. Extracts properties from main description\n2. Then re-processes the same properties and adds _source field\n3. Appends both sets to the properties array instead of deduplicating\n\nNote: Some intentional duplicates exist (body: 2x, bodyParameters: 3x, specifyBody: 2x) due to conditional display logic - these are CORRECT and should remain.",
    "evidence": [
      "SOURCE: n8n/packages/nodes-base/nodes/HttpRequest/V3/Description.ts",
      "  - Contains 33 property definitions",
      "  - Some properties intentionally repeated with different displayOptions (correct behavior)",
      "",
      "EXTRACTED: extracted_docs/http_request_data.json",
      "  - properties.length = 64",
      "  - Pattern: Every property appears twice",
      "",
      "EXAMPLE - 'authentication' property appears twice:",
      "{",
      "  \"displayName\": \"Authentication\",",
      "  \"name\": \"authentication\",",
      "  \"type\": \"options\",",
      "  \"default\": \"none\"",
      "  // No _source field",
      "},",
      "{",
      "  \"displayName\": \"Authentication\",",
      "  \"name\": \"authentication\",",
      "  \"type\": \"options\",",
      "  \"default\": \"none\",",
      "  \"_source\": \"_mainProperties\"  // Added in 2nd extraction",
      "}",
      "",
      "UI ELEMENTS DUPLICATION:",
      "  - notices: 3 unique \u2192 appears as 6 entries",
      "  - placeholders: 9 unique \u2192 appears as 18 entries",
      "  - Same content, just duplicated",
      "",
      "VERIFICATION:",
      "  $ jq '.properties | length' extracted_docs/http_request_data.json",
      "  Output: 64",
      "",
      "  $ jq '[.properties[].name] | unique | length' extracted_docs/http_request_data.json",
      "  Output: 28 unique names (some intentional duplicates with different displayOptions)",
      "",
      "  $ jq '[.properties[] | select(._source == \"_mainProperties\")] | length' extracted_docs/http_request_data.json",
      "  Output: 32 (half the properties have _source field)"
    ],
    "fix_approach": "Implement deduplication in property extraction:\n\n1. Identify where properties get the _source: '_mainProperties' tag\n   - Search n8n_node_extractor.py for '_mainProperties' string\n   - Check NodeExtractor.extract_info() property processing logic\n   - Find where properties array is built/appended\n\n2. Implement deduplication logic:\n   - Option A: Don't add _source tag for main properties (simple fix)\n   - Option B: Deduplicate by (name, displayOptions) key before saving\n   - Option C: Track processed properties to avoid re-extraction\n\n3. Preserve intentional duplicates:\n   - Properties with DIFFERENT displayOptions should remain\n   - Example: body property appears 2x with different show conditions\n   - Only remove exact duplicates where all fields match\n\n4. Test cases:\n   - python3 n8n_node_extractor.py extract HttpRequest\n   - Verify: jq '.properties | length' shows ~33 not 64\n   - Verify: Intentional duplicates remain (body, bodyParameters, specifyBody)\n   - Verify: UI elements not duplicated (3 notices, 9 placeholders)\n\n5. Check other nodes:\n   - Sample 10 random nodes and check for duplicate _source patterns\n   - Fix may benefit entire extraction system\n\nExpected result: 33 properties extracted (vs current 64), UI elements correct count"
  },
  "ownership": {
    "assigned_to": "claude_code",
    "locked_by": null,
    "lock_acquired_at": null,
    "lock_expires_at": null,
    "claimed_at": "2025-11-07T19:43:31.006225Z"
  },
  "resolved_by": "claude_code",
  "resolved_at": "2025-11-07T21:34:38.858231Z"
}