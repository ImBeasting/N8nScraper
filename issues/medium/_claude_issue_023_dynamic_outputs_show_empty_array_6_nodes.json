{
  "issue_id": "_claude_issue_023",
  "title": "Dynamic outputs/inputs show as empty arrays - affects Switch, Webhook, Merge, and 3 other nodes",
  "severity": "medium",
  "status": "new",
  "priority": 3,
  "metadata": {
    "created_at": "2025-11-07T00:00:00Z",
    "created_by": "claude_code",
    "affected_nodes": "Switch V2, Switch V3, Webhook, RespondToWebhook, Merge V3, Evaluation (6 nodes total)",
    "validation_session": "comprehensive_cross_reference_2025-11-07"
  },
  "description": {
    "problem": "Nodes with dynamic outputs/inputs (determined at runtime based on user configuration) show empty arrays in extracted data instead of documenting their dynamic nature",
    "impact": "MEDIUM - Misleading documentation suggests nodes have no outputs when they actually do. AI models may learn incorrect behavior. Users confused by empty outputs field. Inconsistent with static nodes (If shows ['Main', 'Main'], Switch shows []).",
    "root_cause": "Extractor uses simple regex pattern to match static array syntax only:\n\nLine 1979 in n8n_node_extractor.py:\noutputs_match = re.search(r\"outputs:\\s*\\[([^\\]]+)\\]\", main)\n\nThis pattern matches: outputs: [NodeConnectionTypes.Main, ...]\nBut FAILS to match: outputs: '={{(${configuredOutputs})($parameter)}}'\n\nDynamic outputs/inputs use template expressions that call functions to determine outputs at runtime based on parameters like:\n- Switch: mode (rules/expression), numberOutputs, rules array length\n- Webhook: responseMode parameter\n- Merge: mode parameter\n\nThe extractor cannot evaluate these expressions at parse time, so defaults to empty array. However, it should document the dynamic behavior instead of hiding it.",
    "evidence": [
      "AFFECTED NODES (6 total):",
      "",
      "1. Switch V3 (n8n/packages/nodes-base/nodes/Switch/V3/SwitchV3.node.ts:49)",
      "   outputs: '={{(${configuredOutputs})($parameter)}}'",
      "   Extracted: outputs: []",
      "   Should have: Dynamic based on mode + numberOutputs/rules",
      "",
      "2. Switch V2 (multi-line expression for outputs)",
      "   Extracted: outputs: []",
      "",
      "3. Webhook (dynamic outputs based on responseMode)",
      "   outputs: '={{(${configuredOutputs})($parameter)}}'",
      "   Extracted: outputs: []",
      "",
      "4. RespondToWebhook (dynamic outputs)",
      "   Extracted: outputs: []",
      "",
      "5. Merge V3 (dynamic inputs)",
      "   inputs: '={{(${configuredInputs})($parameter)}}'",
      "   Extracted: inputs: []",
      "",
      "6. Evaluation (dynamic inputs and outputs)",
      "   Extracted: inputs: [], outputs: []",
      "",
      "COMPARISON - Static vs Dynamic:",
      "- If node: outputs: [NodeConnectionTypes.Main, NodeConnectionTypes.Main]",
      "  Extracted: outputs: ['Main', 'Main'] ✅",
      "  outputNames: ['true', 'false'] ✅",
      "",
      "- Filter node: outputs: [NodeConnectionTypes.Main]",
      "  Extracted: outputs: ['Main'] ✅",
      "  outputNames: ['Kept', 'Discarded'] ✅",
      "",
      "- Switch node: outputs: '={{(${configuredOutputs})($parameter)}}'",
      "  Extracted: outputs: [] ❌",
      "  Should document: Dynamic outputs based on configuration",
      "",
      "VERIFICATION:",
      "  $ jq '.node_info.outputs' extracted_docs/switch_data.json",
      "  Output: []",
      "",
      "  $ grep -A 5 'outputs:' n8n/packages/nodes-base/nodes/Switch/V3/SwitchV3.node.ts",
      "  Shows: outputs: '={{(${configuredOutputs})($parameter)}}'"
    ],
    "fix_approach": "Document dynamic outputs/inputs instead of showing empty arrays:\n\n1. Detect dynamic outputs/inputs patterns:\n   - Check if outputs/inputs value starts with '=' or '${{'\n   - Check if it contains function calls like ${configuredOutputs}\n   - Pattern: outputs: '={{...' or multi-line expressions\n\n2. Extract metadata about what makes them dynamic:\n   - Parse which parameters control outputs/inputs\n   - For Switch: mode, numberOutputs, rules array, fallbackOutput\n   - For Webhook: responseMode\n   - For Merge: mode\n\n3. Add new fields to node_info:\n   outputs_type: 'static' | 'dynamic'\n   outputs_depends_on: { parameter: description }\n   outputs_description: 'Generated based on configuration'\n\n4. Example output for Switch:\n   {\n     \"outputs\": [],\n     \"outputs_type\": \"dynamic\",\n     \"outputs_description\": \"Number of outputs determined by mode and configuration\",\n     \"outputs_depends_on\": {\n       \"mode\": \"'rules' or 'expression' - determines output structure\",\n       \"numberOutputs\": \"For expression mode - number of outputs (default: 4)\",\n       \"rules.values\": \"For rules mode - 1 output per rule\",\n       \"options.fallbackOutput\": \"Optional fallback output if no rules match\"\n     }\n   }\n\n5. Update markdown generation:\n   - Add note: \"⚠️ This node has dynamic outputs based on configuration\"\n   - Document what parameters control outputs\n\n6. Test cases:\n   - python3 n8n_node_extractor.py extract Switch\n   - Verify: outputs_type = 'dynamic'\n   - Verify: outputs_depends_on documents parameters\n   - Test all 6 affected nodes\n\n7. Implementation location:\n   - Update extract_metadata() around line 1978-1985\n   - Add dynamic detection logic\n   - Parse parameters that control outputs/inputs\n\nExpected result: Dynamic nodes clearly documented, not shown as empty"
  },
  "ownership": {
    "assigned_to": null,
    "locked_by": null,
    "lock_acquired_at": null,
    "lock_expires_at": null,
    "claimed_at": null
  }
}
